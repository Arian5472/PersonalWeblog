@model PostUpdateDTO
@{
    ViewBag.Title = "ویرایش نوشته‌";
    ViewBag.Description = "ویرایش یکی از نوشته‌های موجود";
    ViewBag.Hidden = true;
    ViewBag.NoAside = true;
}

<h1>ویرایش نوشته</h1>
<form action="~/posts/edit/@Model.Slug?ap=@ViewBag.ap" method="post" enctype="multipart/form-data">
    <div>
        
        <input asp-for="Slug" class="form-input" hidden />
        <div class="flex w-50">
            <div class="w-25">
                <label asp-for="Title" class="form-label">
                    عنوان
                </label>
            </div>
            <div class="w-60">
                <input asp-for="Title" class="form-input" />
                <span asp-validation-for="Title" style="color: red;"></span>
            </div>
        </div>
        <br />
        <div class="flex w-50">
            <div class="w-25">
                <label asp-for="Description" class="form-label">
                    توضیحات
                </label>
            </div>
            <div class="w-60">
                <textarea asp-for="Description" class="form-input"></textarea>
                <span asp-validation-for="Description" style="color: red;"></span>
            </div>
        </div>
        <br />

        <div style="width: 100%; box-sizing: border-box;">
            <div style="margin-bottom: 15px;">
                <label asp-for="Article" class="form-label">
                    متن
                </label>
            </div>
            <div>
                <textarea asp-for="Article"></textarea>
                <span asp-validation-for="Article" style="color: red;"></span>
            </div>
        </div>
        <br />

        <div class="flex w-50">
            <div class="w-25">
                <label asp-for="Header" class="form-label">
                    تصویر هدر
                </label>
            </div>
            <div class="w-60">
                <input asp-for="Header" class="form-input" />
                <span asp-validation-for="Header" style="color: red;"></span>
                @if (ViewBag.FormatError != null)
                {
                    <span style="color: red;">@ViewBag.FormatError</span>
                }
            </div>
        </div>
        <br />
        <button class="button button-green-back" style="width: 100; margin: 20px;">ویرایش</button>
		<button class="button button-green-back" style="width: 100; margin: 20px; margin-top: 0px; background-color: red;"><a href="~/posts/delete/@Model.Slug?ap=@ViewBag.ap" style="color: #ffffff;">حذف</a></button>
    </div>
</form>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer" asp-fallback-test="window.jQuery" asp-fallback-src="~/js/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.4/jquery.validate.min.js" integrity="sha512-FOhq9HThdn7ltbK8abmGn60A/EMtEzIzv1rvuh+DqzJtSGq8BRdEN0U+j0iKEIffiw/yEtVuladk6rsG4X6Uqg==" crossorigin="anonymous" referrerpolicy="no-referrer" asp-fallback-test="window.jQuery.validator" asp-fallback-src="~/js/jquery.validate.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validation-unobtrusive/3.2.12/jquery.validate.unobtrusive.min.js" integrity="sha512-o6XqxgrUsKmchwy9G5VRNWSSxTS4Urr4loO6/0hYdpWmFUfHqGzawGxeQGMDqYzxjY9sbktPbNlkIQJWagVZQg==" crossorigin="anonymous" referrerpolicy="no-referrer" asp-fallback-test="window.jQuery.validator.unobstrusive" asp-fallback-src="~/js/jquery.validate.unobstrusive.min.js"></script>

<script type="importmap">
    {
        "imports": {
            "ckeditor5": "../../assets/vendor/ckeditor5.js",
            "ckeditor5/": "../../assets/vendor/"
        }
    }
</script>
<script type="module">
    import {
        ClassicEditor,
        AccessibilityHelp,
        Autoformat,
        AutoImage,
        Autosave,
        BlockQuote,
        Bold,
        CloudServices,
        Essentials,
        FontBackgroundColor,
        FontColor,
        FontFamily,
        FontSize,
        Heading,
        ImageBlock,
        ImageCaption,
        ImageInline,
        ImageInsert,
        ImageInsertViaUrl,
        ImageResize,
        ImageStyle,
        ImageTextAlternative,
        ImageToolbar,
        ImageUpload,
        Indent,
        IndentBlock,
        Italic,
        Link,
        LinkImage,
        List,
        ListProperties,
        MediaEmbed,
        Paragraph,
        PasteFromOffice,
        SelectAll,
        SimpleUploadAdapter,
        TextTransformation,
        TodoList,
        Underline,
        Undo
    } from 'ckeditor5';

    ClassicEditor
        .create(document.querySelector('#Article'), {
			plugins: [
				AccessibilityHelp,
				Autoformat,
				AutoImage,
				Autosave,
				BlockQuote,
				Bold,
				CloudServices,
				Essentials,
				FontBackgroundColor,
				FontColor,
				FontFamily,
				FontSize,
				Heading,
				ImageBlock,
				ImageCaption,
				ImageInline,
				ImageInsert,
				ImageInsertViaUrl,
				ImageResize,
				ImageStyle,
				ImageTextAlternative,
				ImageToolbar,
				ImageUpload,
				Indent,
				IndentBlock,
				Italic,
				Link,
				LinkImage,
				List,
				ListProperties,
				MediaEmbed,
				Paragraph,
				PasteFromOffice,
				SelectAll,
				SimpleUploadAdapter,
				TextTransformation,
				TodoList,
				Underline,
				Undo
			],
			toolbar: {
				items: [
					'undo',
					'redo',
					'|',
					'heading',
					'|',
					'fontSize',
					'fontFamily',
					'fontColor',
					'fontBackgroundColor',
					'|',
					'bold',
					'italic',
					'underline',
					'|',
					'link',
					'insertImage',
					'mediaEmbed',
					'blockQuote',
					'|',
					'bulletedList',
					'numberedList',
					'todoList',
					'outdent',
					'indent'
				],
				shouldNotGroupWhenFull: false
			},

			fontFamily: {
				supportAllValues: true
			},
			fontSize: {
				options: [10, 12, 14, 'default', 18, 20, 22],
				supportAllValues: true
			},
			heading: {
				options: [
					{
						model: 'paragraph',
						title: 'Paragraph',
						class: 'ck-heading_paragraph'
					},
					{
						model: 'heading1',
						view: 'h1',
						title: 'Heading 1',
						class: 'ck-heading_heading1'
					},
					{
						model: 'heading2',
						view: 'h2',
						title: 'Heading 2',
						class: 'ck-heading_heading2'
					},
					{
						model: 'heading3',
						view: 'h3',
						title: 'Heading 3',
						class: 'ck-heading_heading3'
					},
					{
						model: 'heading4',
						view: 'h4',
						title: 'Heading 4',
						class: 'ck-heading_heading4'
					},
					{
						model: 'heading5',
						view: 'h5',
						title: 'Heading 5',
						class: 'ck-heading_heading5'
					},
					{
						model: 'heading6',
						view: 'h6',
						title: 'Heading 6',
						class: 'ck-heading_heading6'
					}
				]
			},
			image: {
				toolbar: [
					'toggleImageCaption',
					'imageTextAlternative',
					'|',
					'imageStyle:inline',
					'imageStyle:wrapText',
					'imageStyle:breakText',
					'|',
					'resizeImage'
				]
			},
			initialData: "@Html.Raw(Model.Article.Replace('\"', '\''))",
			link: {
				addTargetToExternalLinks: true,
				defaultProtocol: 'https://',
				decorators: {
					toggleDownloadable: {
						mode: 'manual',
						label: 'Downloadable',
						attributes: {
							download: 'file'
						}
					}
				}
			},
			list: {
				properties: {
					styles: true,
					startIndex: true,
					reversed: true
				}
			},
			placeholder: 'Type or paste your content here!',
			simpleUpload: {
				uploadUrl: 'https://royayeravi.ir/posts/uploadimage',
				withCredentials: false,
				headers: {
				}
			}

        })
        .then(editor => {
            window.editor = editor;
        })
        .catch(error => {
            console.error(error);
        });
</script>

@section head {
    <link rel="stylesheet" href="~/assets/vendor/ckeditor5.css" />
}
